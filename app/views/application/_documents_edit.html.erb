<div class="table-responsive">
  <table class="order-table table">
    <thead>
      <th>Type</th>
      <th>Filename</th>
      <th>Expiration Date</th>
    </thead>
    <% @product.documents.each do |document| %>
      <tr>
        <td><%= document.document_type.type_description %></td>
        <td><%= link_to "#{document.filename}", {:controller => "products", :action => "download_file", :id => @product.id, :filename => document.filename, :path => document.absolute_directory} %></td>
        <% if document.expiration.nil? %>
          <td>No date</td>
        <% else %>
          <td><%= I18n.l document.expiration %></td>
        <% end %>
      </tr>
    <% end %>
  </table>
</div>

<%= form_for @product do |f|%>
  <% f.object.documents.each do |document| %>
    <%= f.fields_for document do |document_form| %>
      <%= document_form.label :document, "Replace: #{document.document_type.type_description}" %>
      <%= document_form.file_field :file %>
      <%= document_form.label :expiration %>
      <%= document_form.date_field :expiration %>
    <% end %>
  <% end %>
  <%= f.submit 'Update documents' %>
<% end %>

<br><br>

<%= form_for :product_document do |f|%>
  <%= f.collection_select :documents, DocumentType.order(:type_code),:id,:type_description, include_blank: false %>
  <%= f.label :file %>
  <%= f.file_field :file %>
  <%= f.label :expiration %>
  <%= f.date_field :expiration %>
  <%= f.submit 'Add new document' %>
<% end %>
